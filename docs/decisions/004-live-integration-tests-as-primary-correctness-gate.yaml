number: 4
title: Live integration tests as primary correctness gate
category: development
status: accepted
decision: >
  Use real Bitbucket Server/Data Center integration tests as the primary source of API behavior truth.
  Do not introduce contract/fixture-based behavior tests initially.
agent_instructions: >
  When implementing any behavior beyond simple parsing or local validation, add or update live tests
  against the local Bitbucket stack. Treat documentation as advisory and server behavior as authoritative.
  Contract tests may be introduced later only after the live suite is mature and stable.
rationale: >
  Bitbucket API documentation is frequently incomplete or inaccurate in edge cases.
  Live tests catch undocumented behavior and permission nuances that contract tests alone can miss.
  Starting live-first reduces false confidence from mocked assumptions.
rejected_alternatives:
  - alternative: Contract tests from day one
    reason: Early contracts tend to encode assumptions before behavior is well understood.
  - alternative: Documentation-only implementation without live verification
    reason: Too risky due to known doc gaps and inconsistencies.
provenance: guided-ai
