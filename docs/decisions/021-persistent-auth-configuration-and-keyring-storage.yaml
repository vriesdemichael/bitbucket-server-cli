number: 21
title: Persistent auth configuration and keyring storage
category: architecture
status: accepted
decision: >
  Implement first-class authentication workflows with persistent host configuration.
  Store non-secret host/profile metadata in a user config file and store secrets in OS keyring.
  Environment variables and command flags override stored configuration at runtime.
agent_instructions: >
  Prefer auth commands over manual environment setup for day-to-day usage.
  Keep precedence deterministic: flags -> environment -> stored config -> defaults.
  Never print secrets in command output or errors.
  If keyring is unavailable, use explicit fallback handling and communicate reduced security.
rationale: >
  This model mirrors proven CLI practices used by tools like gh and improves usability,
  security, and predictability compared with .env-only workflows.
rejected_alternatives:
  - alternative: Environment variables only
    reason: Fragile across shells/sessions and poor multi-host ergonomics.
  - alternative: Plaintext secrets only in config files
    reason: Increases secret exposure risk.
provenance: guided-ai
